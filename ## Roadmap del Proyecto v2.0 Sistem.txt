## **Roadmap del Proyecto v2.0: Sistema de Soporte a la DecisiÃ³n ClÃ­nica FarmacÃ©utica**

### **1. Resumen Ejecutivo**

*   **Objetivo:** Construir un Sistema de Soporte a la DecisiÃ³n ClÃ­nica (CDSS) que identifique los efectos adversos de los medicamentos y proponga soluciones (farmacolÃ³gicas, de parafarmacia y consejos) para mitigarlos, priorizadas segÃºn su evidencia y frecuencia.
*   **Activo Principal:** Un Grafo de Conocimiento ClÃ­nico propietario, con conceptos normalizados (SNOMED CT), relaciones enriquecidas (frecuencia, nivel de evidencia) y validado por un equipo de expertos mÃ©dicos y farmacÃ©uticos.
*   **Ventaja Competitiva:** Creamos una capa de inteligencia (`Efecto Adverso` -> `ES ALIVIADO POR` -> `Producto/Remedio`) que no existe en las bases de datos oficiales, aportando una soluciÃ³n directa, contextualizada y accionable al profesional sanitario.
*   **Mercados Potenciales:** Farmacias Comunitarias, MÃ©dicos de AtenciÃ³n Primaria/Especializada, Hospitales e Industria FarmacÃ©utica, a travÃ©s de una plataforma en la nube (SaaS) con acceso vÃ­a API.

### **2. AnÃ¡lisis de la SituaciÃ³n y Descubrimientos Clave**

*(Esta secciÃ³n permanece sin cambios, ya que documenta los hallazgos iniciales que fundamentan el proyecto)*

Nuestra investigaciÃ³n inicial se centrÃ³ en la descarga de ficheros estÃ¡ticos del NomenclÃ¡tor (XMLs). Sin embargo, el descubrimiento de la documentaciÃ³n de la **API REST de CIMA** ha redefinido por completo nuestra estrategia de adquisiciÃ³n de datos. Los hallazgos clave son el acceso programÃ¡tico en tiempo real, el formato de datos JSON moderno, y endpoints especÃ­ficos para catÃ¡logos (`maestras`), fichas tÃ©cnicas (`docSegmentado`) y sincronizaciÃ³n (`registroCambios`).

### **3. Arquitectura y Pila TecnolÃ³gica**

*   **Entorno de Desarrollo (IDE):** **Visual Studio 2022**.
*   **Lenguaje y Framework Backend:** **C# con .NET 8**.
*   **Data Lake (Almacenamiento de Brutos):** **Azure Blob Storage** (o similar). Su rol es almacenar una copia 1:1 de los JSONs originales de la API de CIMA. Esto garantiza la trazabilidad y nos permite re-procesar los datos a futuro sin depender de la API externa.
*   **Base de Datos Relacional (Staging Area):** **PostgreSQL (PSQL)**, configurado en local para la fase de desarrollo. Su rol serÃ¡ almacenar los datos estructurados de AEMPS y el texto relevante y segmentado de las fichas tÃ©cnicas, listo para ser procesado.
*   **Base de Datos de Grafos (Cerebro del Sistema):** **Neo4j** (o similar). AquÃ­ se construirÃ¡ y residirÃ¡ nuestro Grafo de Conocimiento ClÃ­nico.
*   **Procesamiento de Lenguaje (NLP/LLM):** **Azure OpenAI Service** (o similar) para la extracciÃ³n de entidades, su contexto y un score de confianza.
*   **Control de Versiones:** **Git** (en un repositorio de GitHub o Azure DevOps).

### **4. Hoja de Ruta por Fases**

#### **Fase 1: Cimientos y ConfiguraciÃ³n del Entorno (DuraciÃ³n: 1-2 semanas)**
*   **Objetivo:** Tener un entorno de desarrollo local funcional y validar la comunicaciÃ³n con la API de CIMA.
Â    *   **1.1.** Crear una nueva SoluciÃ³n en Visual Studio ("ClinicalGraph.sln") con un proyecto de API Web en .NET 8.
Â    *   **1.2.** Instalar y configurar un servidor PostgreSQL local. Crear la base de datos ("cima_staging_db").
Â    *   **1.3.** DiseÃ±ar y crear las tablas SQL para los catÃ¡logos principales (ej. `formas\\\_farmaceuticas`, `vias\\\_administracion`).
Â    *   **1.4.** Desarrollar un cliente de API en C# para realizar una llamada de prueba al endpoint `GET maestras` y volcar el resultado.
Â    *   **1.5.** Configurar el repositorio Git.

#### **Fase 2: Ingesta Masiva y EstructuraciÃ³n de Datos (DuraciÃ³n: 4-6 semanas)**
*   **Objetivo:** Crear una rÃ©plica local, completa y organizada de toda la materia prima de AEMPS.
Â    *   **2.1.** Desarrollar un servicio de ingesta ("Ingestion Service").
Â    *   **2.2.** Implementar la lÃ³gica para poblar todas las tablas de catÃ¡logo en PSQL desde el endpoint `GET maestras`.
Â    *   **2.3.** Implementar el proceso principal de carga masiva (a ejecutarse una sola vez):
Â        *   a. Obtener la lista completa de todos los `nregistro` de medicamentos.
Â        *   b. Crear un bucle que, para cada `nregistro`:
Â            *   i. Llame a `GET medicamento` para sus datos estructurados.
Â            *   ii. Llame a `GET docSegmentado/contenido/1` para su Ficha TÃ©cnica en JSON.
Â            *   iii. **(Nuevo)** Guarde el JSON original y completo de la ficha tÃ©cnica en el **Data Lake** (Azure Blob Storage).
Â            *   iv. Guarde los datos estructurados y el texto segmentado de la ficha en las tablas de **PostgreSQL**.
Â    *   **Hito Clave:** Un Data Lake con los datos en bruto y una base de datos PostgreSQL con la materia prima limpia y organizada, lista para ser procesada.

#### **Fase 3: La Capa de Inteligencia - Grafo y CuraciÃ³n (DuraciÃ³n: 8-12 semanas)**
*   **Objetivo:** Transformar los datos en bruto en conocimiento clÃ­nico validado y accionable dentro del grafo.
Â    *   **3.1.** Instalar y configurar la base de datos de grafos (Neo4j).
Â    *   **3.2.** DiseÃ±ar el modelo del grafo:
Â        *   **Nodos:** `Medicamento`, `PrincipioActivo`, `EfectoAdverso` (normalizado con SNOMED CT), `Remedio` (con etiquetas adicionales como `Farmaco`, `Parafarmacia`, `ConsejoNoFarmacologico`), y nodos para futuro contexto como `Patologia`, `Condicion`.
Â        *   **Relaciones:** `CONTIENE`, `TRATA`, `PROVOCA` (con propiedad `frecuencia`), `ALIVIA` (con propiedad `nivel\\\_de\\\_evidencia`), `ES\\\_CONTRINDICADO\\\_PARA`.
Â    *   **3.3.** Desarrollar el servicio de procesamiento ("Processing Service") que lea desde PostgreSQL.
Â    *   **3.4.** Implementar la lÃ³gica de extracciÃ³n con LLM sobre el texto de las fichas para obtener:
Â        *   a. La entidad (ej. "cefalea").
Â        *   b. Un **score de confianza** sobre la extracciÃ³n.
Â        *   c. El texto original (contexto) como evidencia.
Â    *   **3.5.** Implementar un **servicio de normalizaciÃ³n** para mapear entidades extraÃ­das a cÃ³digos **SNOMED CT** antes de insertarlas en el grafo.
Â    *   **3.6.** Poblar el grafo con los nodos y las relaciones `TRATA` y `PROVOCA` extraÃ­das automÃ¡ticamente.
Â    *   **3.7.** **(CrÃ­tico)** Desarrollar la herramienta web interna de curaciÃ³n para expertos con funcionalidades avanzadas:
Â        *   a. **Flujo de "Sugerencia y ValidaciÃ³n"** que pre-carga posibles remedios para agilizar la creaciÃ³n de relaciones `ALIVIA`.
Â        *   b. **Trazabilidad de Evidencia**, mostrando el fragmento de texto original de donde se extrajo cada dato.
Â        *   c. **Cola de Trabajo Priorizada** por el score de confianza del LLM, para que los expertos se enfoquen en los casos mÃ¡s ambiguos.
Â        *   d. **Mecanismo de Feedback** que almacene las correcciones para futuros re-entrenamientos del modelo de extracciÃ³n.
Â    *   **Hito Clave:** Primera versiÃ³n del Grafo de Conocimiento ClÃ­nico, normalizado, enriquecido y validado por expertos.

#### **Fase 4: API y AplicaciÃ³n Piloto (MVP) (DuraciÃ³n: 6-8 semanas)**
*   **Objetivo:** Exponer el valor del grafo a travÃ©s de una API potente y una aplicaciÃ³n de demostraciÃ³n.
Â    *   **4.1.** DiseÃ±ar y desarrollar nuestra API REST (`ClinicalGraph.API`) que permita consultas complejas. Ej: `GET /api/medicamento/{cn}/sugerencias?frecuencia=muy\\\_frecuente\\\&tipo\\\_remedio=parafarmacia`.
Â    *   **4.2.** Desarrollar una aplicaciÃ³n web piloto (MVP) que consuma nuestra API.
Â    *   **4.3.** La aplicaciÃ³n permitirÃ¡ buscar un medicamento y mostrarÃ¡ una lista de sus efectos adversos **ordenados por frecuencia**, y junto a cada uno, las soluciones propuestas **ordenadas por nivel de evidencia**.
Â    *   **Hito Clave:** Un producto funcional (MVP) que demuestra el valor Ãºnico del proyecto y puede ser usado para demos a potenciales clientes.

### **5. VisiÃ³n a Futuro: Escalado a la Nube (Post-MVP)**

Una vez validado el MVP, el siguiente paso estratÃ©gico serÃ¡ migrar la infraestructura de un entorno local a una arquitectura cloud escalable (ej. en Azure o AWS). El objetivo es ofrecer el servicio como una plataforma SaaS (Software as a Service) a la que las farmacias y otros clientes podrÃ¡n conectarse a travÃ©s de:
*   **IntegraciÃ³n con Chatbots:** Proporcionando respuestas inteligentes y contextualizadas.
*   **IntegraciÃ³n en el Punto de Venta (TPV):** Ofreciendo sugerencias proactivas y relevantes durante la dispensaciÃ³n de medicamentos para facilitar la venta cruzada informada.

### **6. PrÃ³ximos Pasos Inmediatos**

1.  **AcciÃ³n 1:** Crear la soluciÃ³n (`.sln`) en Visual Studio con el proyecto de API Web.
2.  **AcciÃ³n 2:** Instalar PostgreSQL en el entorno de desarrollo local y crear la base de datos `cima\\\_staging\\\_db`.
3.  **AcciÃ³n 3:** Escribir el cÃ³digo C# para hacer una llamada exitosa al endpoint `GET maestras?maestra=3` y mostrar la lista de formas farmacÃ©uticas por consola para validar la conexiÃ³n.

---

Este roadmap ahora es un plan de acciÃ³n mucho mÃ¡s completo y a prueba de futuro. Estoy listo para empezar cuando tÃº lo estÃ©s.




Â¡Brutal el avance! ğŸ’¥ Ya tienes la base sÃ³lida y limpia. Voy a darte mi **plan de juego** (sin cÃ³digo, como pediste) para convertir esto en el mejor buscador relacional + grafo + vector del mercado, pensando ya en el agente/chatbot.

# Mi opiniÃ³n y hoja de ruta (priorizada)

## 1) Normalizar lo que mÃ¡s valor aporta (fase corta, impacto alto)

**a) Principios activos (pactivos)**

* **Entidad**: Sustancia (id, nombre normalizado, sinÃ³nimos).
* **RelaciÃ³n**: Medicamento â€”\[CONTIENE]â†’ Sustancia (con propiedades: **fuerza**, **unidad**, **forma/vÃ­a** si aplica).
* **Por quÃ© primero**: habilita queries clÃ­nicas reales (â€œibuprofeno + paracetamolâ€, â€œsin AASâ€, etc.) y es el eje del grafo.

**b) Excipientes (excipientes)**

* **Entidad**: Excipient (id, nombre normalizado).
* **RelaciÃ³n**: Medicamento â€”\[TIENE\_EXCIPIENTE]â†’ Excipient (flag **declaraciÃ³n obligatoria**, notas).
* **Valor**: alertas de alergias/intolerancias (â€œsin lactosaâ€, â€œsin sacarosaâ€, â€œsin aceite de sojaâ€). Diferenciador real.

**c) ATC**

* **Entidad**: ATC (cÃ³digo, nombre, **padre** para el Ã¡rbol).
* **RelaciÃ³n**: Medicamento â€”\[CLASIFICADO\_EN]â†’ ATC.
* **Valor**: navegas terapÃ©uticamente (â€œdame todos los AINEsâ€, â€œtodos los N02C analgÃ©sicos antimigraÃ±ososâ€). AdemÃ¡s es un **eje jerÃ¡rquico** perfecto para el grafo.

**d) Estado/comercializaciÃ³n/fechas**

* En tabla Medicamentos: **comerc**, **estado.aut** (fecha autorizaciÃ³n), **estado.rev** (si viene), y **suspensiones** si existen.
* **Valor**: filtras por â€œen comercializaciÃ³nâ€, â€œautorizado desdeâ€¦â€, etc., y generas indicadores.

**e) Alertas rÃ¡pidas**

* Booleans: **conduc** (afecta conducciÃ³n), **triangulo** (seguimiento adicional).
* **Valor**: filtros y badges en UI al instante.

**f) Documentos y fotos (metadatos)**

* **Entidad**: Documento (tipo FT/P/IPE, url, fecha, hash si luego los cacheas).
* **RelaciÃ³n**: Medicamento â€”\[TIENE\_DOC]â†’ Documento.
* **Valor**: trazabilidad y **provenance** para el chatbot (â€œfuente: FT 70039 secciÃ³n 4.2â€).

> Con solo esto ya tienes un \\\*\\\*buscador estructurado\\\*\\\* potentÃ­simo y un \\\*\\\*grafo Ãºtil\\\*\\\* (Medicamentoâ†”Sustanciaâ†”ATC), listo para enriquecer recomendaciones y razonamiento del agente.

---

## 2) DiseÃ±o de grafo (quÃ© nodos y aristas)

**Nodos**:

* Medicamento, Sustancia, Excipient, ATC (con jerarquÃ­a), Forma, VÃ­a, Laboratorio (Titular/Comercializador), Documento.
Â  **Aristas clave**:
* Medicamentoâ€“CONTIENEâ†’Sustancia (props: fuerza, unidad).
* Medicamentoâ€“TIENE\_EXCIPIENTEâ†’Excipient (props: obligado).
* Medicamentoâ€“CLASIFICADO\_ENâ†’ATC.
* ATCâ€“PADRE\_DEâ†’ATC (jerarquÃ­a).
* Medicamentoâ€“FORMAâ†’Forma; Medicamentoâ€“VIAâ†’VÃ­a.
* Medicamentoâ€“TITULARâ†’Laboratorio; â€“COMERCIALIZAâ†’Laboratorio.
* Medicamentoâ€“TIENE\_DOCâ†’Documento.

**Consultas tÃ­picas que esto resuelve como mantequilla**:

* â€œAnti-inflamatorios **sin** lactosa y **vÃ­a oral**â€
* â€œIbuprofeno + pseudoefedrina, **comercializados** hoyâ€
* â€œAnalgÃ©sicos con **triÃ¡ngulo negro**â€
* â€œSustancias relacionadas a este ATC y sus medicamentos hijos del Ã¡rbolâ€

---

## 3) Estrategia de vectores (RAG de verdad, no humo)

**Â¿QuÃ© vectorizamos?**

* El **contenido semÃ¡ntico** de FT/P/IPE (SmPC): Indicaciones, posologÃ­a (4.2), contraindicaciones (4.3), advertencias (4.4), interacciones (4.5), embarazo/lactancia (4.6), conducciÃ³n (4.7), reacciones adversas (4.8).
* **Chunking**: por secciÃ³n y subtÃ­tulo; tamaÃ±o moderado con solape pequeÃ±o; **id de chunk** + **metadatos** (nregistro, secciÃ³n, fecha doc).
* **Index hÃ­brido**:

Â  * **Filtro estructural primero** (SQL/Graph): ATC, vÃ­a, forma, sustancia, flags (conduc/triÃ¡ngulo), comercializaciÃ³nâ€¦
Â  * **Luego** vector search solo sobre los chunks candidatos (rÃ¡pido y preciso).
Â  * (Opcional) **re-ranker** textual para el top-k final.

**Flujo del agente/chatbot**

1. **Comprende intenciÃ³n + facetas** â†’ traduce a **filtros estructurados** (SQL/grafo).
2. **Recupera candidatos** (NRegistros).
3. **RAG**: busca chunks vectoriales solo de esos candidatos.
4. **Cita** siempre FT/P con secciÃ³n/fecha (provenance).
5. Si pregunta es puramente estructural (â€œsin lactosaâ€), puede responder **sin RAG**.

**Ventaja competitiva**: precisiÃ³n clÃ­nica + velocidad (menos ruido, chunks muy relevantes) + explicabilidad (citas exactas).

---

## 4) Calidad de datos (clave para â€œser los mejoresâ€)

* **NormalizaciÃ³n de nombres** (lowercase, tildes, guiones, formas salinas versus base) y **sinÃ³nimos** (p. ej., â€œibuprofeno lisinaâ€ vs â€œibuprofen lysineâ€).
* **IDs estables**: usa los IDs que ya trae CIMA (cuando existan) para sustancias/excipientes/ATC; si no, genera internos pero mapea.
* **DesambiguaciÃ³n de fuerzas**: guarda **cantidad** + **unidad** por sustancia (no solo cadena â€œ200 mgâ€).
* **ATC jerÃ¡rquico**: asegÃºrate de cargar **toda la cadena** (A â†’ A01 â†’ A01A â†’ A01AA â†’ A01AA01â€¦). Puedes hacerlo con un campo `parent\\\_code` o Ã¡rbol.

---

## 5) Rendimiento / UX

* Postgres: ya tienes trgm + tsvector; aÃ±ade **materialized views** para facetas (por ATC, por sustancia, por excipiente) si hace falta.
* Para grafo: si sigues en Postgres, podrÃ­as tirar con tablas N\:M; si quieres explotar queries de caminos, **Neo4j** te darÃ¡ mucha agilidad.
* MantÃ©n `RawJson` Ã­ntegro para auditorÃ­a y **ETL incremental** desde `/registroCambios` refrescando las tablas normalizadas, relaciones y el Ã­ndice vectorial.

---

## 6) QuÃ© harÃ­a **inmediatamente** (prÃ³ximos mini-pasos)

1. **Principios activos** (esqueleto relacional + volcado desde RawJson) â€” *habilita AND/OR por sustancias*.
2. **Excipientes** (con flag â€œdeclaraciÃ³n obligatoriaâ€).
3. **ATC** (con jerarquÃ­a).
4. **Booleans y fechas** (comerc, aut, rev, conduc, triangulo) en Medicamentos.
5. **Documentos** (metadatos) para provenance del chatbot.
6. **Luego**: Ã­ndice vectorial con los FT/P/IPE ya linkados.

> Cuando me digas â€œOK, vamos con 1) Principios activosâ€, te paso \\\*\\\*solo el punto 1\\\*\\\*, lo ejecutas, me devuelves resultado, y seguimos con el 2. Cero prisas, cero volcado de info de golpe.

---

## 7) Â¿CuÃ¡ndo creamos los vectores?

DespuÃ©s de 1â€“5 (sobre todo **Documentos**), porque el vector store debe guardar **metadatos** limpios (nregistro, tipo doc, secciÃ³n, fecha). AsÃ­ el agente puede:

* filtrar por estructura â†’ **RAG** sobre esos candidatos â†’ citar secciÃ³n exacta.
* Y el Ã­ndice vectorial se re-construye **incrementalmente** cuando cambien los docs (hash/fecha).

---

Si te parece bien esta ruta, dime: **â€œvamos con 1) Principios activosâ€** y te doy **Ãºnicamente** ese paso (sin nada mÃ¡s) para psql.






El Plano Maestro Definitivo y Corregido (VersiÃ³n Final)
Revisada toda la conversaciÃ³n, el plan de juego que aprobamos y tu briefing, esta es la lista exhaustiva y COMPLETA de todo lo que necesitamos en nuestra base de datos.
1. Tablas Maestras (CatÃ¡logos)
âœ… SustanciaActiva (Hecho)
âœ… FormaFarmaceutica (Hecho)
âœ… FormaFarmaceuticaSimplificada (Hecho)
âœ… Vtm (Hecho)
âœ… ViaAdministracion (Hecho)
ğŸ“‹ Excipiente (Por hacer)
ğŸ“‹ AliasExcipiente (Por hacer) - Tu idea, la mantenemos.
ğŸ“‹ Atc (Por hacer) - Con CodigoPadre para la jerarquÃ­a.
ğŸ“‹ Laboratorio (Por hacer)
ğŸ“‹ Documento (Por hacer) - Para los metadatos de FT/Prospecto.
2. Tablas de RelaciÃ³n (Conectores N:M)
âœ… MedicamentoSustancia (Hecho y enriquecido)
âœ… MedicamentoVia (Hecho)
ğŸ“‹ MedicamentoExcipiente (Por hacer) - Con el importantÃ­simo flag Obligatorio.
ğŸ“‹ MedicamentoAtc (Por hacer)
3. La Tabla Central: Medicamentos
AquÃ­ es donde se me han quedado cosas. Esta es la lista completa de columnas que debe tener la tabla Medicamentos al final del proceso.
Columnas existentes (validadas):
âœ… Id (uuid)
âœ… NRegistro (varchar, UNIQUE)
âœ… Nombre (varchar)
âœ… Dosis (varchar)
âœ… Generico (boolean)
âœ… Receta (boolean)
âœ… RawJson (jsonb - para el resumen de lista)
âœ… CreatedAt (timestamptz)
âœ… UpdatedAt (timestamptz)
Columnas de relaciÃ³n (FKs) y "Banderas de Alerta RÃ¡pida" (POR AÃ‘ADIR/COMPLETAR):
Relaciones 1:N
â• LaboratorioTitularId (INT, FK a Laboratorio)
â• LaboratorioComercializadorId (INT, FK a Laboratorio)
Estado / ComercializaciÃ³n / Fechas (Punto d del plan)
â• Comercializado (BOOLEAN) - para el flag comerc
â• FechaAutorizacion (TIMESTAMPTZ) - para estado.aut
â• FechaSuspension (TIMESTAMPTZ, nullable) - para estado.susp
â• FechaRevocacion (TIMESTAMPTZ, nullable) - para estado.rev
Â¡Â¡Alertas RÃ¡pidas!! (Punto e del plan - el que me he dejado antes)
â• AfectaConduccion (BOOLEAN) - para el flag conduc
â• TrianguloNegro (BOOLEAN) - para el flag triangulo
â• Fotos (BOOLEAN) - para saber si tiene fotos disponibles
â• MaterialesInformativos (BOOLEAN) - para el flag materialesInf
â• Huerfano (BOOLEAN) - para el flag huerfano
â• Biosimilar (BOOLEAN) - para el flag biosimilar
â• Psum (BOOLEAN) - para el flag psum (Problema de Suministro)
Enriquecimiento y Trazabilidad (como definimos)
â• RawJsonDetalle (JSONB)
â• EnrichedAt (TIMESTAMPTZ)



Vale, ahora sÃ­, pongamos la **visiÃ³n SOTA**.
TÃº ya tienes la base sÃ³lida (medicamentos, diccionarios, relaciones clÃ¡sicas). Lo siguiente es **levantar capas semÃ¡nticas y clÃ­nicas** que hagan que tu grafo no sea solo una base de medicamentos, sino un **mapa farmacolÃ³gico cognitivo** comparable a lo que usan hospitales de Ã©lite.

AquÃ­ te dejo las **tablas relacionales nuevas** que darÃ¡n un salto diferencial:

---

### 1. **Indicaciones TerapÃ©uticas**

* **MedicamentoIndicacion** (NRegistro â†” IndicaciÃ³nId, + tipo: principal/secundaria, aprobado/off-label, nivel de evidencia).
* **Indicacion** (Id, Nombre, CIE-10/11, SNOMED-CT, OntologÃ­a propia).
  ğŸ‘‰ Valor: mapa claro de *para quÃ© sirve* cada fÃ¡rmaco, alineado con estÃ¡ndares mÃ©dicos.

---

### 2. **Efectos Adversos**

* **MedicamentoEfectoAdverso** (NRegistro â†” EfectoAdversoId, + severidad, frecuencia, secciones de origen).
* **EfectoAdverso** (Id, Nombre normalizado, CÃ³digos MedDRA/CTCAE).
  ğŸ‘‰ Valor: trazabilidad riesgo â†’ fÃ¡rmaco; detectar patrones poblacionales o multi-fÃ¡rmaco.

---

### 3. **Interacciones Medicamentosas**

* **InteraccionFarmacoFarmaco** (NRegistro1, NRegistro2, tipo: potenciaciÃ³n, antagonismo, toxicidad; nivel evidencia).
* **InteraccionFarmacoAlimento** (NRegistro â†” AlimentoId, + efecto: inhibiciÃ³n, potenciaciÃ³n, absorciÃ³n reducida).
* **Alimento/Nutriente** (Id, Nombre, categorÃ­a).
  ğŸ‘‰ Valor: grafo clÃ­nico avanzado (lo que usan los sistemas CDSS para alertar en hospitales).

---

### 4. **Poblaciones Especiales**

* **MedicamentoPoblacion** (NRegistro â†” PoblacionId, + notas de ajuste, riesgo, contraindicaciÃ³n).
* **Poblacion** (Id, Nombre: embarazo, lactancia, pediatrÃ­a, geriatrÃ­a, insuficiencia renal/hepÃ¡tica).
  ğŸ‘‰ Valor: personalizaciÃ³n clÃ­nica (lo que se acerca a la medicina de precisiÃ³n).

---

### 5. **PosologÃ­a y Ajustes**

* **MedicamentoPosologia** (NRegistro, dosis mÃ­nima/mÃ¡xima, frecuencia, vÃ­a, notas).
* **MedicamentoAjuste** (NRegistro â†” FactorAjusteId, + regla: ajuste por creatinina, genotipo, peso, etc.).
* **FactorAjuste** (Id, Nombre, tipo: fisiolÃ³gico/genÃ©tico/farmacocinÃ©tico).
  ğŸ‘‰ Valor: conecta farmacologÃ­a con biomarcadores y condiciones individuales.

---

### 6. **FarmacogenÃ³mica / Biomarcadores**

(ya tienes base con *MedicamentoBiomarcador*):

* Expandir con **Relaciones indirectas**: biomarcador â†” enfermedad â†” respuesta.
* AÃ±adir **NivelEvidencia** y **RecomendaciÃ³n ClÃ­nica** (p. ej. CPIC guidelines).
  ğŸ‘‰ Valor: medicina de precisiÃ³n real, diferencial frente a cualquier base estÃ¡ndar.

---

### 7. **Alertas de Seguridad**

* **MedicamentoAlerta** (NRegistro â†” AlertaId, + fuente: EMA, FDA, AEMPS; fecha inicio/fin).
* **AlertaFarmacologica** (Id, tipo: retirada, black-box warning, lote afectado).
  ğŸ‘‰ Valor: capa dinÃ¡mica de farmacovigilancia; sÃºper valiosa para mÃ©dicos/farmacÃ©uticos.

---

### 8. **Combinaciones y Protocolos**

* **MedicamentoProtocolo** (ProtocoloId â†” Medicamento, rol: fÃ¡rmaco base / coadyuvante).
* **Protocolo** (Id, Nombre: quimioterapia X, profilaxis Y).
  ğŸ‘‰ Valor: permite razonar a nivel de tratamientos completos, no solo fÃ¡rmacos aislados.

---

### 9. **FarmacoeconomÃ­a y Disponibilidad**

* **MedicamentoPrecio** (NRegistro, fecha, presentaciÃ³n, precio, reembolso, genÃ©rico/referencia).
* **MedicamentoDisponibilidad** (NRegistro, estado: comercializado/no disponible).
  ğŸ‘‰ Valor: capa estratÃ©gica para hospitales y gestores sanitarios.

---

ğŸ”‘ **Resumen**:
Con todo esto tendrÃ¡s un **grafo vivo** con relaciones de:

* **QuÃ© trata** (indicaciones),
* **QuÃ© provoca** (efectos adversos, interacciones),
* **En quiÃ©n y cÃ³mo** (poblaciones, ajustes, posologÃ­a, biomarcadores),
* **Con quÃ© contexto** (protocolos, seguridad, economÃ­a).

ğŸ‘‰ Esto ya es **nivel CDSS hospitalario premium**, y si lo unes a tu pipeline de prospectos + fichas tÃ©cnicas, estarÃ¡s adelantando al 95% de las soluciones comerciales globales.

---

Â¿Quieres que te arme un **diagrama conceptual del grafo final** con estas tablas aÃ±adidas para que veas la red completa?
